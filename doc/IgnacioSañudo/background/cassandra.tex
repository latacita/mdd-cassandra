%%==================================================================%%
%% Author : Sañudo Olmedo, Ignacio                                  %%
%%          Sánchez Barreiro, Pablo                                 %%
%% Version: 1.1, 18/06/2014                                         %%
%%                                                                  %%
%% Memoria del Proyecto Fin de Carrera                              %%
%% Background/Cassandra                                             %%
%===================================================================%%
%http://www.nosql-database.org/
%[chalmers]
%http://www.acens.com/wp-content/images/2014/02/bbdd-nosql-wp-acens.pdf
%http://www.strozzi.it/cgi-bin/CSA/tw7/I/en_US/NoSQL/Philosophy%20of%20NoSQL
Esta sección realiza una breve descripción sobre Cassandra, desde su historia, arquitectura, sintaxis y otras características que explican como es el sistema de bases de datos no relacional escogido para este proyecto de fin de carrera.

%http://books.google.es/books?id=tv5iO9MnObUC&printsec=frontcover&dq=nosql+books&hl=es&sa=X&ei=XHjrU7mWFpGg7Abk6oCIDw&ved=0CDoQ6AEwAA#v=onepage&q=nosql%20books&f=false
Desde que nació SQL en el año 1974 se ha convertido en el lenguaje de consultas utilizado por excelencia. En los últimos años ha surgido otra vertiente denominada NoSQL la cual surge por la necesidad de manejo de grandes volúmenes de información no estructurada, distribuida y accedida con la mayor rapidez posible.
NoSQL es literalmente (como es evidente) la combinación de dos palabras: No y SQL, hoy en día este término se utiliza para denominar todas las bases de datos que no siguen los principios de los sistema de gestión de bases de datos relacionales tradicionales. Es usado en plataformas como Facebook o Twitter. Podemos encontrar varios tipos de bases de datos no relacionales, por ejemplo: Bases de datos documentales, bases de datos orientadas a columnas, orientadas a grafos ente otros.

Existen varias diferencias entre estos sistemas NoSQL y sistemas SQL, las principales características de NoSQL que difieren de SQL son:
\begin{enumerate}
\item NoSQL no garantiza las propiedades ACID (atomicidad, coherencia, aislamiento y durabilidad).
\item No utiliza SQL como lenguaje de consultas. Algunas bases de datos no relacionales utilizan SQL como lenguaje de apoyo sin embargo la mayoría utilizan su propio lenguaje de consultas como por ejemplo Cassandra que utiliza CQL.
\item No está permitido el uso de joins ya que al manejar grandes volúmenes de información una consulta con un join puede llegar a sobrecargar el sistema.
\item Escalan horizontalmente y trabajan de manera distribuida por lo que la información puede estar en distintas maquinas y el añadir nodos mejora el rendimiento.
\item Resuelven problemas de altos volúmenes de información
\end{enumerate}

En este proyecto de fin de carrera se utiliza Cassandra como sistema de bases de datos no relacional. Apache Cassandra fue diseñado por Avinash Lakshman (uno de los creadores de Amazon's Dynamo) y Prashant Malik (Ingeniero de Facebook), en estos momentos se encuentra en producción para Facebook. Dentro del mundo de las bases de datos no relaciones Cassandra es considerada un híbrido de los sistemas orientados a columnas y las bases de datos basadas en clave-valor. Las basadas en clave-valor tienen como peculiaridad que almacenan los datos en forma de columna. Esto permite el acceso a los datos de forma rápida, básicamente, utilizan una tabla hash en la que existe una clave única y un puntero a un elemento de datos en particular.
Los sistemas basados en clave-valor son aquellos que asocian los valores a una determinada clave esto permite la recuperación y escritura de información de forma muy rápida y eficiente.

Cassandra reúne las  tecnologías de sistemas distribuidos de Amazon Dynamo y el modelo de datos BigTable de Google. Por ejemplo, al igual que Dynamo, es consistente. Como BigTable, proporciona un modelo de datos basado en column families siendo considerado el sistema orientado a columnas más popular.
Las bases de datos basadas en Cassandra son soluciones utilizadas cuando es necesaria escalabilidad y alta disponibilidad sin comprometer el rendimiento. Escalabilidad lineal y tolerancia a fallos o infraestructura en la nube lo convierten en la plataforma idónea para datos de misión critica. Además proporciona gran estabilidad en cuanto a la replicación de datos a través de múltiples datacenters, consiguiendo una menor latencia para sus usuarios y la tranquilidad de que no existan perdidas de datos ante caídas. Cassandra utiliza el lenguaje de consultas CQL (Cassandra Query Language) con una sintaxis muy similar a SQL aunque mas limitado que este. Como herramienta de manipulación y administración de datos se utiliza DataStax OpsCenter que ofrece una interfaz de usuario basada en navegador que sirve para la gestión y monitorización de los cluster Cassandra en una única terminal de administración.

%https://cassandra.apache.org/ http://www.datastax.com/documentation/cql/3.0/cql/ddl/ddl_intro_c.html

A continuación se explican brevemente algunos términos que hay que tener en cuenta a la hora de trabajar con Cassandra.
En Cassandra un keyspace es el equivalente a un schema en los sistemas de bases de datos relacionales.
El conocido término de tabla en las bases de datos relacionales tiene su equivalente en Cassandra llamado column family, las column families se guardan en ficheros separados y son ordenadas por su key.
Una columna es la unidad de almacenamiento básica, está formada de tres campos: Nombre, valor y timestamp. El nombre y el valor se almacena como una matriz de bytes sin procesar y pueden ser de cualquier tamaño. Los tres valores anteriores son introducidos por el cliente, incluido el timestamp. Un ejemplo de la estructura de una column:
\begin{table}[!hbt]
\begin{center}
\begin{tabular}{||l | c | r||}
\hline
\hline
\textbf{Nombre de la columna} & Username \\
\hline
\textbf{Valor de Username} & Ignacio \\
\hline
\textbf{Timestamp} & 123456789 \\
\hline
\end{tabular}
\caption{Ejemplo estructura columna}
\end{center}
\end{table}
Por lo tanto un keyspace puede contener varias column families y una column family a su vez contiene varias columnas. La estructura de una column family queda como se puede observar en la figura~\ref{back:fig:estructuraCF}.
\begin{figure}[!tb]
  \centering
  \includegraphics[width=.8\linewidth]{background/images/estructuraCF.eps} \\
  \caption{Estructura column family}
  \label{back:fig:estructuraCF}
\end{figure}

	
En cuanto a la sintaxis del lenguaje CQL es muy similar a SQL, CQL contiene sintaxis ya conocida de SQL como INSERT, DELETE, UPDATE, INSERT,  ...
La Figura~\ref{back:code:codigoCQL} refleja un ejemplo breve de código CQL ejecutable.

\begin{figure}[!tb]
\begin{center}
\begin{footnotesize}
\begin{verbatim}

DROP KEYSPACE twitter;

CREATE KEYSPACE twitter
WITH replication = {'class':'SimpleStrategy', 'replication_factor':2};

USE twitter;

CREATE TABLE Tweet(
       UUID text,
       usernameTw text,
       body text,
       PRIMARY KEY(UUID)
);

CREATE TABLE User(
       username text,
       password text,
       followers set<text>,
       followings set<text>,
       tweets_written list<text>,
       PRIMARY KEY(username)
);

\end{verbatim}
\end{footnotesize}
\end{center}
\caption{Ejemplo código CQL}
\label{back:code:codigoCQL}
\end{figure}

Conceptos relacionados con Cassandra son ampliados en el siguiente capitulo a la hora de definir el meta-modelo de Cassandra.


